---
title: C++拷贝控制
tags: C++
categories: Language
---

# 对象移动

## 右值引用

* 左值引用绑定到返回`左值`的表达式

  右值引用或`const`的左值引用绑定到返回`右值`的表达式

* 右值要么是字面常量，要么是临时对象。右值引用只能绑定到右值，所以可以接管所引用对象的资源

  * 所引用对象将要被销毁
  * 该对象没有其它用户

* 变量是`左值`

  * 不能把`右值引用`直接绑定到一个变量,即使这个变量是右值引用类型

  ```c++
  int &&rr1 = 42;
  int &&rr2 = rr1; //错误: rr1是右值引用类型的变量,它是个左值
  ```

* `move()`将`左值`转换为`右值引用`.

  ```c++
  int && rr3 = std::move(rr1);
  ```

  * 可以销毁移后源对象,可以赋予其新值,但不能使用移后源对象的值
  * 对`move`不提供`using`声明, 直接调用`std::move`而非`move`
  * 在头文件`<utility>`中

## 移动构造函数和移动赋值运算符

```c++
class X
{
    int a;
public:
    X(int x)
    {
        a = x;
    }
    
    //委托构造
    X()
    : x(42)
    {}
    
};
```


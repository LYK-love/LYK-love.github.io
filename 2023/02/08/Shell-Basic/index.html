<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/white_flower1.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/white_flower1.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/white_flower1.jpg">
  <link rel="mask-icon" href="/images/white_flower1.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lyk-love.cn","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.13.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":"flat"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":"enable","trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Outline:  Shell Basic Shell and Syscall User Environment Linux Shell Windows Shell">
<meta property="og:type" content="article">
<meta property="og:title" content="Shell Basic">
<meta property="og:url" content="http://lyk-love.cn/2023/02/08/Shell-Basic/index.html">
<meta property="og:site_name" content="LYK-love">
<meta property="og:description" content="Outline:  Shell Basic Shell and Syscall User Environment Linux Shell Windows Shell">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://seec2-lyk.oss-cn-shanghai.aliyuncs.com/Hexo/Toolkit/Shel%20lSession%20Archetecture">
<meta property="article:published_time" content="2023-02-08T07:44:07.954Z">
<meta property="article:modified_time" content="2023-04-23T12:52:52.476Z">
<meta property="article:author" content="有多远滚多远">
<meta property="article:tag" content="shell">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://seec2-lyk.oss-cn-shanghai.aliyuncs.com/Hexo/Toolkit/Shel%20lSession%20Archetecture">


<link rel="canonical" href="http://lyk-love.cn/2023/02/08/Shell-Basic/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://lyk-love.cn/2023/02/08/Shell-Basic/","path":"2023/02/08/Shell-Basic/","title":"Shell Basic"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Shell Basic | LYK-love</title>
  

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?07a572cad308bc3b22d354fca4209fed"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="LYK-love" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">LYK-love</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Shell-Basic"><span class="nav-text">Shell Basic</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#shell-categories"><span class="nav-text">shell categories</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Shell-Session"><span class="nav-text">Shell Session</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Shell-and-Syscall"><span class="nav-text">Shell and Syscall</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#shell-workflow"><span class="nav-text">shell workflow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shell-%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">shell 重定向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session-%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E9%94%80%E6%AF%81"><span class="nav-text">Session 的创建和销毁</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#User-Environment"><span class="nav-text">User Environment</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Linux-shell"><span class="nav-text">Linux shell</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PATH"><span class="nav-text">PATH</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Navigating-in-the-shell"><span class="nav-text">Navigating in the shell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Connecting-programs"><span class="nav-text">Connecting programs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#root"><span class="nav-text">root</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Command-Parameters"><span class="nav-text">Command Parameters</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%AD%E5%8F%82%E6%95%B0"><span class="nav-text">短参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%BF%E5%8F%82%E6%95%B0"><span class="nav-text">长参数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Windows-shell"><span class="nav-text">Windows shell</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="有多远滚多远"
      src="/images/white_flower1.jpg">
  <p class="site-author-name" itemprop="name">有多远滚多远</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">216</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">50</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/LYK-love" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;LYK-love" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:191820133@smail.nju.edu.cn" title="E-Mail → mailto:191820133@smail.nju.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://lyk-love.cn/2023/02/08/Shell-Basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/white_flower1.jpg">
      <meta itemprop="name" content="有多远滚多远">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYK-love">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Shell Basic | LYK-love">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Shell Basic
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-02-08 07:44:07" itemprop="dateCreated datePublished" datetime="2023-02-08T07:44:07Z">2023-02-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-04-23 12:52:52" itemprop="dateModified" datetime="2023-04-23T12:52:52Z">2023-04-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Toolkit/" itemprop="url" rel="index"><span itemprop="name">Toolkit</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Outline:</p>
<ul>
<li>Shell Basic</li>
<li>Shell and Syscall</li>
<li>User Environment</li>
<li>Linux Shell</li>
<li>Windows Shell</li>
</ul>
<span id="more"></span>
<h1 id="Shell-Basic"><a class="header-anchor" href="#Shell-Basic"></a>Shell Basic</h1>
<p>Shell语言的文档详见拙著<em>Shell Script</em>， 本文只介绍Shell程序的基本概念</p>
<p>抽象的说，Shell泛指所有提供<strong>用户和操作系统的接口</strong>的程序，位于用户态的最底层。 可分为文本界面的命令行程序( Command LIne, aka CLI )和图形界面程序( Graphic User Interface, aka GUI )。 一般来说，“Shell”指的都是CLI</p>
<ul>
<li>The user interface program, <strong>shell</strong> or <strong>GUI</strong>, is the <u>lowest level of user-mode software</u>, and allows the user to start other programs --- 拙著 <em>OS Introduction</em></li>
</ul>
<p>从实现上讲，Shell程序就是一个<strong>解释器</strong>，它接受的语言就被称为Shell语言( <em>Shell Script</em>)。 用户将Shell语言输入给Shell， 后者执行命令。</p>
<ul>
<li>注意，不同的Shell实现，也会形成一些自己的方言。不过一般不用考虑那么多，只要了解其中最标准的子集即可</li>
</ul>
<p>Linux中有多种shell，默认使用的是Bash</p>
<h2 id="shell-categories"><a class="header-anchor" href="#shell-categories"></a>shell categories</h2>
<table>
<thead>
<tr>
<th>shell名称</th>
<th>描述</th>
<th>位置</th>
</tr>
</thead>
<tbody>
<tr>
<td>ash</td>
<td>一个小的shell，但与bash完全兼容</td>
<td>/bin/ash</td>
</tr>
<tr>
<td>ash.static</td>
<td>一个不依靠软件库的ash版本</td>
<td>/bin/ash.static</td>
</tr>
<tr>
<td>bin</td>
<td>ash的一个符号链接</td>
<td>/bin/ash</td>
</tr>
<tr>
<td>bash</td>
<td>“Bourne Again Shell”。由GNU开发，保持了对 sh shell 的(大部分)兼容性，是各种 Linux 发行版默认配置的 shell</td>
<td>/bin/bash</td>
</tr>
<tr>
<td>sh</td>
<td>Bourne shell，是 UNIX 上的标准 shell</td>
<td>/bin/sh</td>
</tr>
<tr>
<td>ksh</td>
<td>Korn Shell</td>
<td>/bin/ksh</td>
</tr>
<tr>
<td>csh</td>
<td>C shell,  该shell的语法有点类似C语言</td>
<td>/bin/csh</td>
</tr>
<tr>
<td>tcsh</td>
<td>csh 的增强版，加入了命令补全功能，提供了更加强大的语法支持</td>
<td>/bin/tcsh</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>在现代的 Linux 上，sh 已经被 bash 代替。 sh在Linux中是bash的一个符号链接； 在mac中是一个独立的程序</p>
</li>
<li>
<p>当前 Linux 系统可用的 Shell 都记录在<code>/etc/shells</code>文件中：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">❯ cat /etc/shells</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/etc/shells: valid login shells</span></span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/usr/bin/bash</span><br><span class="line">/bin/rbash</span><br><span class="line">/usr/bin/rbash</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Shell-Session"><a class="header-anchor" href="#Shell-Session"></a>Shell Session</h2>
<p>Shell session 是终端中当前的状态，在终端中只能有一个 session。当我们打开一个新的终端时，总会创建一个新的 shell session。</p>
<p>就进程间的关系来说，session 由一个或多个进程组组成。一般情况下，来自单个登录的所有进程都属于同一个 session。我们可以通过下图来理解进程、进程组和 session 之间的关系：</p>
<p><img data-src="https://seec2-lyk.oss-cn-shanghai.aliyuncs.com/Hexo/Toolkit/Shel%20lSession%20Archetecture" alt="Shell Session Archetecture"></p>
<p>会话是由会话中的第一个进程创建的，<strong>一般情况下是打开终端时创建的 shell 进程</strong>。该进程也叫 session 的领头进程。Session 中领头进程的 PID 也就是 session 的 SID。我们可以通过下面的命令查看 SID：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ps -o pid,ppid,pgid,sid,tty,comm</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> PID    PPID    PGID     SID TT       COMMAND</span><br><span class="line">5745    5729    5745    5745 pts/4    zsh</span><br><span class="line">5785       1    5784    5745 pts/4    zsh</span><br><span class="line">5787       1    5784    5745 pts/4    zsh</span><br><span class="line">5789       1    5788    5745 pts/4    zsh</span><br><span class="line">5794    5789    5788    5745 pts/4    gitstatusd</span><br><span class="line">5844    5745    5844    5745 pts/4    ps</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Session 中的每个进程组被称为一个 <strong>job</strong>，有一个 job 会成为 session 的前台 job(foreground)，其它的 job 则是后台 job(background)。每个 session 连接一个控制终端(control terminal)，控制终端中的输入被发送给前台 job，从前台 job 产生的输出也被发送到控制终端上。同时由控制终端产生的信号，比如 ctrl + z 等都会传递给前台 job。</p>
<p>一般情况下 session 和终端是一对一的关系，当我们打开多个终端窗口时，实际上就创建了多个 session。</p>
<p>Session 的意义在于多个工作(job)在一个终端中运行，其中的一个为前台 job，它直接接收该终端的输入并把结果输出到该终端。其它的 job 则在后台运行。</p>
<h1 id="Shell-and-Syscall"><a class="header-anchor" href="#Shell-and-Syscall"></a>Shell and Syscall</h1>
<p>由于系统调用<code>fork()</code>和<code>exec()</code>的分离，程序可以在<code>fork()</code>之后，<code>exec()</code>之前运行代码，方便了shell的工作</p>
<h2 id="shell-workflow"><a class="header-anchor" href="#shell-workflow"></a>shell workflow</h2>
<ul>
<li><code>shell</code>的workflow：
<ol>
<li>显示一个<code>prompt</code>,等待用户输入</li>
<li>用户进行输入，输入内容是一个命令，由一个可执行程序和若干参数组成</li>
<li><code>shell</code>找到该可执行程序。调用<code>fork()</code>创建新进程</li>
<li><code>shell</code>可能执行某些代码</li>
<li>调用<code>exec()</code>执行这个可执行程序</li>
<li>调用<code>wait()</code>等待该命令完成</li>
<li>子进程执行结束后，shell从<code>wait()</code>返回，继续步骤1</li>
</ol>
</li>
</ul>
<h2 id="shell-重定向"><a class="header-anchor" href="#shell-重定向"></a>shell 重定向</h2>
<p>shell实现重定向：对于<code> wc 5_2.c &gt; [filename].txt</code>, wc的输出结果被重定向到<code>[filename].txt</code></p>
<p>步骤解释：</p>
<ol>
<li>
<p>shell在<code>fork()</code>之后，<code>exec()</code>之前，会：</p>
<ol>
<li>先用<code>open</code>打开文件<code>[filename].txt</code>, 给它分配一个文件描述符, 记为<code>STDOUT_FILENO</code>(一般是3，因为0，1，2都已被占用)</li>
<li>再关闭标准输出( fd = 1 )</li>
</ol>
</li>
<li>
<p>shell使用<code>dup</code>/<code>dup2</code>来分配一个<code>STDOUT_FILENO</code>的复制，由于<code>dup</code>默认是分配未使用的最小的fd），此时fd=1已经关闭，所以就又分配了fd=1，它是<code>STDOUT_FILENO</code>的复制</p>
</li>
<li>
<p>shell执行指令，子进程准备输出，由于UNIX系统会从零开始寻找可用的fd(文件描述符)，因此<code>STDOUT_FILENO</code>会成为第一个可用的fd，作为子进程输出的目标</p>
</li>
</ol>
<p>详见<em>OS Persistence</em></p>
<ul>
<li>UNIX pipe也用类似方式实现，但使用<code>pipe()</code>系统调用,将前一个进程的输入作为后一个进程的输出：<code>grep -o foo fole | wc -l</code></li>
</ul>
<h2 id="Session-的创建和销毁"><a class="header-anchor" href="#Session-的创建和销毁"></a>Session 的创建和销毁</h2>
<p>session的创建：</p>
<ul>
<li>通常，新的 session 由系统登录程序创建，session 中的领头进程是运行用户登录 shell 的进程。新创建的每个进程都会属于一个进程组，当创建一个进程时，它和父进程在同一个进程组、session 中。</li>
</ul>
<p>将进程放入不同 session 的惟一方法是使用 <code>setsid</code> 函数使其成为新 session 的领头进程。这还会将 session 领头进程放入一个新的进程组</p>
<p>session的销毁：</p>
<ul>
<li>当 session 中的所有进程都结束时 session 也就消亡了。实际使用中比如网络断开了，session 肯定是要消亡的。</li>
<li>让 session 的领头进程退出。一般情况下 session 的领头进程是 shell 进程，如果它处于前台，我们可以使用 exit 命令或者是 ctrl + d 让它退出。或者我们可以直接通过 kill 命令杀死 session 的领头进程。
<ul>
<li>原理是：当系统检测到挂断(hangup)条件时，内核中的驱动会将 SIGHUP 信号发送到整个 session。通常情况下，这会杀死 session 中的所有进程</li>
</ul>
</li>
</ul>
<p>session 与终端的关系：</p>
<ul>
<li>
<p>如果 session 关联的是<strong>伪终端</strong>，这个伪终端本身就是随着 session 的建立而创建的，session 结束，那么这个伪终端也会被销毁。</p>
<ul>
<li>
<p>打开终端，会话开始；关闭终端，会话结束，会话内部的进程也会随之终止，不管有没有运行完。</p>
<p>一个典型的例子就是，<a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html">SSH 登录</a>远程计算机，打开一个远程终端执行命令。这时，网络突然断线，再次登录的时候，是找不回上一次执行的命令的。因为上一次 SSH 会话已经终止了，里面的进程也随之消失了</p>
<p>为了解决这个问题，会话与窗口可以&quot;解绑&quot;：窗口关闭时，会话并不终止，而是继续运行，等到以后需要的时候，再让会话&quot;绑定&quot;其他窗口（见“ Terminal  Multiplexer”）</p>
</li>
</ul>
</li>
<li>
<p>如果 session 关联的是 <strong>tty</strong>1-6，tty 则不会被销毁。因为该终端设备是在系统初始化的时候创建的，并不是依赖该会话建立的，所以当 session 退出，tty 仍然存在。只是 init 系统在 session 结束后，会重启 getty 来监听这个 tty</p>
</li>
</ul>
<h1 id="User-Environment"><a class="header-anchor" href="#User-Environment"></a>User Environment</h1>
<p>.bash_profile, .bash_logout, .bashrc files</p>
<ul>
<li>.bash_profile: 用户<strong>登录时</strong>被读取，其中包含的命令被bash执行</li>
<li>.bashrc: <strong>启动一个新的shell时</strong>读取并执行</li>
<li>.bash_logout: 登录退出时读取执行</li>
</ul>
<h1 id="Linux-shell"><a class="header-anchor" href="#Linux-shell"></a>Linux shell</h1>
<p>When you launch your terminal, you will see a <em>prompt</em> that often looks a little like this:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">missing:~$ </span><br></pre></td></tr></table></figure>
<ul>
<li>主机名: <code>missing</code></li>
<li>当前工作目录: <code>~</code> (short for “home”).</li>
<li>The <code>$</code> tells you that you are not the root user \</li>
</ul>
<p>The most basic command is to execute a program with arguments:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo hello</span><br></pre></td></tr></table></figure>
<ul>
<li>shell对命令的解析:
<ul>
<li>按空格分隔</li>
<li>第一个单词是命令名字,以后的每个单词都是命令的参数</li>
<li>If you want to provide an argument that contains spaces or other special characters (e.g., a directory named “My Photos”), you can either quote the argument with <code>'</code> or <code>&quot;</code> (<code>&quot;My Photos&quot;</code>), or escape just the relevant characters with <code>\</code> (<code>My\ Photos</code>)</li>
</ul>
</li>
</ul>
<h2 id="PATH"><a class="header-anchor" href="#PATH"></a>PATH</h2>
<p>shell变量分为用户变量和[环境变量].</p>
<p><code>$PATH</code>是特殊的环境变量， 当shell执行一条和其所有关键字都不匹配的命令时,它会查询 <code>$PATH</code> , 它列出了所有shell在查询命令时应查找的目录( 以 <code>:</code>分割 )</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">missing:~$ echo $PATH</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line">missing:~$ which echo</span><br><span class="line">/bin/echo</span><br><span class="line">missing:~$ /bin/echo $PATH</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br></pre></td></tr></table></figure>
<ul>
<li>We can also bypass <code>$PATH</code> entirely by giving the <em>path</em> to the file we want to execute.</li>
</ul>
<h2 id="Navigating-in-the-shell"><a class="header-anchor" href="#Navigating-in-the-shell"></a>Navigating in the shell</h2>
<ul>
<li>
<p>根目录:  <code>/</code> is the “root” of the file system</p>
</li>
<li>
<p>A path that starts with <code>/</code> is called an <em>absolute</em> path. Any other path is a <em>relative</em> path.</p>
</li>
<li>
<p>Relative paths are relative to the current working directory, which we can see with the <code>pwd</code> command</p>
</li>
<li>
<p>In a path, <code>.</code> refers to the current directory, and <code>..</code> to its parent directory:</p>
</li>
<li>
<p>Most commands accept flags and options (flags with values) that start with <code>-</code> to modify their behavior</p>
</li>
<li>
<p>文件权限： File的权限与人们的直觉相符， 而对于Directory:</p>
<ul>
<li>To enter a directory, a user must have “search” (represented by “execute”: <code>x</code>)</li>
<li>To list its contents, a user must have read (<code>r</code>) permissions on that directory.</li>
</ul>
</li>
</ul>
<h2 id="Connecting-programs"><a class="header-anchor" href="#Connecting-programs"></a>Connecting programs</h2>
<ul>
<li><code>&lt;</code>, <code>&gt;</code>重定向（覆盖原文件内容）</li>
<li><code>&lt;&lt;</code>, <code>&gt;&gt;</code> append模式</li>
</ul>
<h2 id="root"><a class="header-anchor" href="#root"></a>root</h2>
<p><code>su</code>： 切换到root</p>
<p><code>sudo CMD</code>： 以root权限执行CMD, 注意只有第一条CMD具有root权限</p>
<p>One thing you need to be root in order to do is writing to the <code>sysfs</code> file system mounted under <code>/sys</code>. <code>sysfs</code> exposes a number of kernel parameters as files, so that you can easily reconfigure the kernel on the fly without specialized tools. <strong>Note that sysfs does not exist on Windows or macOS.</strong></p>
<p>For example, the brightness of your laptop’s screen is exposed through a file called <code>brightness</code> under</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/sys/class/backlight</span><br></pre></td></tr></table></figure>
<p>By writing a value into that file, we can change the screen brightness. Your first instinct might be to do something like:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo find -L /sys/class/backlight -maxdepth 2 -name &#x27;*brightness*&#x27;</span><br><span class="line">/sys/class/backlight/thinkpad_screen/brightness</span><br><span class="line">$ cd /sys/class/backlight/thinkpad_screen</span><br><span class="line">$ sudo echo 3 &gt; brightness</span><br><span class="line">An error occurred while redirecting file &#x27;brightness&#x27;</span><br><span class="line">open: Permission denied</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>注意</strong>：<code>|</code>, <code>&gt;</code>, and <code>&lt;</code> 这些操作符是由shell提供的，  <code>echo</code>这些程序只接受输入、进行输出， 不知道这些操作符的存在， 因此shell首先用root权限运行<code>echo 3</code>， 再用默认权限（即shell的创建者）的权限打开<code>brightness</code>文件尝试写入， 而这需要root权限， 因此fail</p>
<p>Using this knowledge, we can work around this:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo 3 | sudo tee brightness</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Command-Parameters"><a class="header-anchor" href="#Command-Parameters"></a>Command Parameters</h2>
<p>Linux Command的命令行参数可分为长参数（long option）和短参数（short option），长参数形式类似于<code>--print-something</code>， 以<code>--</code>开头，单词间以<code>-</code>分开；短参数形式类似于<code>-p</code>，以<code>-</code>开头，后面跟单词缩写</p>
<h3 id="短参数"><a class="header-anchor" href="#短参数"></a>短参数</h3>
<p>在短参数中，字母的大写效果是不同的，比如大写 <code>T</code> 和小写 <code>t</code>的含义通常不同</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">command -p</span><br></pre></td></tr></table></figure>
<p>短参数赋值：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">command -p 10</span><br></pre></td></tr></table></figure>
<p>多个短参数，可以用空格隔开:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">command -a -b -c -d</span><br></pre></td></tr></table></figure>
<p>多个短参数也可以合并在一起：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">command -abcd</span><br></pre></td></tr></table></figure>
<h3 id="长参数"><a class="header-anchor" href="#长参数"></a>长参数</h3>
<p>格式：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">command --parameter</span><br></pre></td></tr></table></figure>
<p>长参数赋值：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">command --parameter=10</span><br></pre></td></tr></table></figure>
<p>多个长参数，不能像多个短参数那样合并， 只能以空格隔开：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">command --parameter1 --parameter2</span><br></pre></td></tr></table></figure>
<p><strong>可以组合使用短参数和长参数</strong><br>
例如：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">command -abcd --parameter1 --parameter2</span><br></pre></td></tr></table></figure>
<h1 id="Windows-shell"><a class="header-anchor" href="#Windows-shell"></a>Windows shell</h1>
<p>windows中：命令和文件名(包括文件类型)不区分大小写. 即 cd 和 CD 一样， dir 和 DIR 一样。 Desktop 和 desktop 一样, *.pdf  和 *.PDF 一样</p>
<p>TAB键： 自动补完。 不区分大小写</p>
<p><code>cd</code> ： change directory 改变目录</p>
<p><code>cd .. </code> : go back to upper directory 回到上一级目录， 注意cd 和 .. 中间也可以没有空格</p>
<p><code>cd ../..</code> :  回到上两级目录</p>
<p><code>cd \</code> : 回到根目录</p>
<p><code>exit</code>: 退出</p>
<p><code>dir</code> ： list the contents of current directory 浏览当前目录（结果按字母顺序排序）.  文件有<DIR>代表它也是个目录</p>
<p><code>dir Desktop\SE</code> 查看SE的内容， 不会改变当前目录</p>
<p><code>dir Desktop\SE\*.pdf</code>   遍历并列出SE中以.pdf结尾的文件</p>
<p>注意文件名是区分空格的，所以<code>dir Desktop \SE</code> 或 <code>dir Desktop\ SE</code>  找不到东西</p>
<p><code>dir /a</code>: show hidden directories as well 注意dir 和 /a 中间也可以没有空格</p>
<p><code>cls</code>： clear your screen</p>
<p><code>↑</code>键 ：access your command history</p>
<p><code> /?</code> : to access help and options menu</p>
<p><code>mkdir</code>   制作目录</p>
<p><code>rmdir</code> 删除一个空的目录</p>
<p><code>rmdir *** /s</code> 删除一个有内容的目录</p>
<p><code>Home</code>键： bring u to  to the beginning of the command</p>
<p><code>End</code>键：反之</p>
<p><code>Ctrl+left</code> : 一次左移一个词</p>
<p>——————————————————————————————————</p>
<ul>
<li>
<p><code>echo not sweet &gt; apple.txt</code>  向 apple.txt中添加not sweet（这会覆盖txt的原内容）</p>
</li>
<li>
<p>如果不想覆盖，只想append， 那就用<code>echo not sweet &gt;&gt; apple.txt</code></p>
</li>
<li>
<p><code>Desktop\test&gt; dir &gt; apple.txt</code>    向apple.txt中添加test的目录</p>
</li>
<li>
<p>总之 <code>Desktop\test&gt; *** &gt; apple.txt</code> 星号部分是向apple.txt中添加的内容，可以是文字，可以是命令， 说到命令，当然·<code>ttrib</code>也可以，<code>cls</code>也可以。不过把cls append进去很蠢，啥都不会发生。</p>
</li>
</ul>
<p>—————————————————————————————————</p>
<p><code>type 文件名</code> ： 在CMD中打印该文件的内容</p>
<p><code>remove 被移动的 移动到的</code> ： 顾名思义，当然，连空文件和空目录也会移动</p>
<p><code>rename 原名 新名字</code> ： 注意文件类型也在名字里，所以一个 XX.txt如果更名为YY(不带.txt)，那么XX会从一个文本文档变成一个文件夹</p>
<p>—————————————————————————————————</p>
<p><code> copy</code> 要被复制的 复制到的 ： 文件复制</p>
<p><code>xcopy</code>: 也是复制，但比copy更好（功能更多） 。 xcopy默认只会复制source中的文件，而不包括目录（copy也是如此）。 通过/S 可以让xcopy复制目录和子目录，不包括空目录。， 但copy没有/S的功能，也就是说copy无法复制目录。</p>
<p>要打开应用程序，要么转到对应的目录，然后 <code>start ** .exe</code>, 要么直接用双引号括住绝对路径</p>
<p><code> C:\Users\color 0B</code>   数字是背景颜色，字母是foreground or text</p>
<p><code>wmic logicaldisk get name</code> : see all the available command drives</p>
<p><code> tree</code>关键字： 以树状列出目录及其内部目录…</p>
<p>D: 转到D盘根路径</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/shell/" rel="tag"># shell</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/02/08/Python%20Basic/" rel="prev" title="Python Basic">
                  <i class="fa fa-chevron-left"></i> Python Basic
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/02/08/T1&T2%20%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%88%86%E6%B2%BB/" rel="next" title="T1&T2 排序与分治">
                  T1&T2 排序与分治 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2021 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">有多远滚多远</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
